{{BOLD}}ergo quickstart{{RESET}}
{{CYAN}}A 5-minute walkthrough. Run these commands as you read.{{RESET}}

{{HEADER}}1. INITIALIZE{{RESET}}

{{CMD}}mkdir demo && cd demo{{RESET}}
{{CMD}}ergo init{{RESET}}

{{COMMENT}}creates .ergo/ with events.jsonl{{RESET}}
{{COMMENT}}ergo discovers .ergo/ like git finds .git/{{RESET}}

{{CMD}}ergo where{{RESET}}
{{COMMENT}}prints the active .ergo path{{RESET}}

{{HEADER}}2. CREATE AN EPIC AND TASKS{{RESET}}

{{CMD}}ergo new epic "Build auth system"{{RESET}}
{{COMMENT}}prints epic ID, e.g. E-a1b2c3{{RESET}}
{{CMD}}ergo new task "Design token format" --epic E-a1b2c3{{RESET}}
{{CMD}}ergo new task "Implement JWT signing" --epic E-a1b2c3{{RESET}}
{{CMD}}ergo new task "Add refresh tokens" --epic E-a1b2c3{{RESET}}

{{COMMENT}}each prints a task ID, e.g. T-d4e5f6{{RESET}}
{{CMD}}ergo list{{RESET}}

{{HEADER}}3. ADD DEPENDENCIES{{RESET}}

{{COMMENT}}'dep A B' means A depends on B (B blocks A){{RESET}}
{{COMMENT}}JWT signing depends on token format design:{{RESET}}
{{CMD}}ergo dep T-impl T-design{{RESET}}
{{COMMENT}}refresh tokens depend on JWT signing:{{RESET}}
{{CMD}}ergo dep T-refresh T-impl{{RESET}}
{{CMD}}ergo list --blocked{{RESET}}
{{COMMENT}}shows T-impl and T-refresh (waiting on deps){{RESET}}

{{CMD}}ergo list --ready{{RESET}}
{{COMMENT}}only T-design is ready (no unmet deps){{RESET}}
{{CMD}}ergo dep rm T-refresh T-impl{{RESET}}
{{COMMENT}}removes the dependency if needed{{RESET}}

{{HEADER}}4. WORK ON TASKS{{RESET}}

{{CMD}}ergo next{{RESET}}
{{COMMENT}}claims oldest ready task, sets state=doing, prints it{{RESET}}
{{COMMENT}}if no ready tasks, exits with code 3{{RESET}}
{{CMD}}ergo next --peek{{RESET}}
{{COMMENT}}see what's next without claiming{{RESET}}

{{COMMENT}}mark your work done:{{RESET}}
{{CMD}}ergo set T-design state=done{{RESET}}
{{CMD}}ergo list --ready{{RESET}}

{{HEADER}}5. UPDATE TASKS{{RESET}}

{{CMD}}ergo set T-impl title="Implement JWT signing (HS256)"{{RESET}}
{{CMD}}ergo set T-impl state=blocked{{RESET}}
{{COMMENT}}explicit block (waiting on external input){{RESET}}

{{CMD}}ergo set T-impl state=todo{{RESET}}
{{COMMENT}}unblock when ready to resume{{RESET}}

{{HEADER}}6. HANDLE FAILURES{{RESET}}

{{COMMENT}}if a task fails, mark it as error (preserves who failed):{{RESET}}
{{CMD}}ergo set T-impl state=error{{RESET}}
{{COMMENT}}dependents are blocked until error is resolved{{RESET}}

{{COMMENT}}retry the failed task:{{RESET}}
{{CMD}}ergo set T-impl claim=$AGENT_ID{{RESET}}
{{COMMENT}}or reassign to someone else:{{RESET}}
{{CMD}}ergo set T-impl state=todo{{RESET}}
{{COMMENT}}or give up:{{RESET}}
{{CMD}}ergo set T-impl state=canceled{{RESET}}

{{HEADER}}7. ATTACH RESULTS{{RESET}}

{{COMMENT}}tasks can have result files — visible in normal tools (editor, finder):{{RESET}}
{{CMD}}echo "# Analysis Report" > docs/analysis.md{{RESET}}
{{CMD}}ergo set T-design result.path=docs/analysis.md result.summary="Token format analysis"{{RESET}}

{{COMMENT}}results are attached, not moved:{{RESET}}
{{COMMENT}}  - file stays in your project (not in .ergo/){{RESET}}
{{COMMENT}}  - ergo stores: path, sha256, mtime, git commit (at attach time){{RESET}}
{{COMMENT}}  - humans open docs/analysis.md directly; agents use show --json{{RESET}}

{{CMD}}ergo show T-design{{RESET}}
{{COMMENT}}shows result summary, path, and file:// URL{{RESET}}

{{CMD}}ergo show T-design --json | jq '.results'{{RESET}}
{{COMMENT}}structured: path, file_url, sha256_at_attach, etc.{{RESET}}

{{COMMENT}}attach multiple results by repeating set:{{RESET}}
{{CMD}}ergo set T-design result.path=docs/spec.md result.summary="Final spec document"{{RESET}}

{{COMMENT}}verify drift (agent pattern):{{RESET}}
{{COMMENT}}  1. get sha256_at_attach from show --json{{RESET}}
{{COMMENT}}  2. compute sha256 of current file{{RESET}}
{{COMMENT}}  3. if different, file was edited since attach{{RESET}}

{{HEADER}}8. HUMAN VS AGENT TASKS{{RESET}}

{{COMMENT}}some tasks need human judgment:{{RESET}}
{{CMD}}ergo new task "Choose token expiry policy" --epic E-a1b2c3{{RESET}}
{{CMD}}ergo set T-policy worker=human{{RESET}}
{{CMD}}ergo list --ready --as human{{RESET}}

{{COMMENT}}agents filter for their work:{{RESET}}
{{CMD}}ergo list --ready --as agent{{RESET}}
{{CMD}}ergo next --as agent{{RESET}}

{{HEADER}}9. EPIC HIERARCHIES{{RESET}}

{{COMMENT}}epics can depend on other epics (nested work):{{RESET}}
{{CMD}}ergo new epic "Design phase"{{RESET}}
{{CMD}}ergo new epic "Build phase"{{RESET}}
{{CMD}}ergo new epic "Deploy phase"{{RESET}}

{{COMMENT}}Build depends on Design, Deploy depends on Build:{{RESET}}
{{CMD}}ergo dep E-build E-design{{RESET}}
{{CMD}}ergo dep E-deploy E-build{{RESET}}

{{COMMENT}}tasks in Build are blocked until Design's tasks are done{{RESET}}
{{COMMENT}}an epic is "complete" when all its tasks are done|canceled{{RESET}}

{{HEADER}}10. AGENT INTEGRATION{{RESET}}

{{COMMENT}}agents should use --json for structured output:{{RESET}}
{{CMD}}ergo --json list --ready --as agent{{RESET}}
{{CMD}}ergo --json next --as agent{{RESET}}
{{COMMENT}}recommended agent loop:{{RESET}}
{{COMMENT}}  1. ergo next --as agent  (claim work){{RESET}}
{{COMMENT}}  2. do the work{{RESET}}
{{COMMENT}}  3. write results to project files (e.g., docs/, reports/){{RESET}}
{{COMMENT}}  4. ergo set <id> result.path=<path> result.summary="<summary>"{{RESET}}
{{COMMENT}}  5. ergo set <id> state=done  (or state=error if failed){{RESET}}

{{COMMENT}}find results from other tasks:{{RESET}}
{{CMD}}ergo show <id> --json | jq '.results[] | {path, summary, sha256_at_attach}'{{RESET}}

{{HEADER}}REFERENCE: STATE MACHINE{{RESET}}

{{COMMENT}}valid state transitions:{{RESET}}
{{COMMENT}}  todo     → doing, done, blocked, canceled{{RESET}}
{{COMMENT}}  doing    → todo, done, blocked, canceled, error{{RESET}}
{{COMMENT}}  blocked  → todo, doing, done, canceled{{RESET}}
{{COMMENT}}  done     → todo (reopen only){{RESET}}
{{COMMENT}}  canceled → todo (reopen only){{RESET}}
{{COMMENT}}  error    → todo, doing, canceled (retry, reassign, or give up){{RESET}}

{{HEADER}}REFERENCE: DEPENDENCY RULES{{RESET}}

{{COMMENT}}  task → task: allowed{{RESET}}
{{COMMENT}}  epic → epic: allowed{{RESET}}
{{COMMENT}}  task ↔ epic: forbidden (no mixing){{RESET}}
{{COMMENT}}  self-dep:    forbidden (A cannot depend on A){{RESET}}
{{COMMENT}}  cycles:      forbidden (A→B→...→A rejected){{RESET}}
