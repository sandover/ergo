{{BOLD}}ergo{{RESET}} â€” fast, minimal plan tracker (tasks + epics + deps). safe for parallel agents.

{{HEADER}}USAGE{{RESET}}
  ergo [global flags] <command> [args]

{{HEADER}}COMMANDS{{RESET}}
  init [dir]                              create .ergo/ in dir (default: current dir)

  new epic                                create epic from JSON stdin (prints ID)
  new task                                create task from JSON stdin (prints ID)

  set <id>                                update task/epic from JSON stdin

  list [--epic <id>] [--ready|--blocked] [--epics]
                                          list tasks; --epics shows only epics
  show <id>                               show epic or task details

  next [--epic <id>] [--peek]             claim oldest READY task, set doing, print it
                                          --peek shows without claiming; exit 3 if none

  dep <A> <B>                             add dependency: A depends on B (B blocks A)
  dep rm <A> <B>                          remove dependency

  where                                   print active .ergo directory path
  compact                                 rewrite log to current state (drops history)
  quickstart                              complete reference manual (agents: run this)

{{HEADER}}GLOBAL FLAGS{{RESET}}
  --dir <path>                            discovery start dir (or explicit .ergo dir)
  --as <any|agent|human>                  filter READY/BLOCKED and next (default: any)
  --agent <id>                            claim identity (default: username@hostname)
  --json                                  JSON output (default: text)
  --readonly                              block commands that write
  --lock-timeout <duration>               default 30s; 0 = fail fast
  -h, --help                              show help
  -V, --version                           print version

{{HEADER}}FOR AGENTS{{RESET}}
  Always use --json for structured output (e.g., ergo --json list --ready --as agent).
  Run `ergo quickstart` for the complete reference including the recommended agent loop.

{{HEADER}}JSON INPUT (stdin only){{RESET}}
  All mutations (new, set) read JSON from stdin:

    echo '{"title":"Build auth","body":"Implement login, signup, and token refresh"}' | ergo new epic
    echo '{"title":"Hash passwords","body":"Use bcrypt with cost=12","epic":"OFKSTE","worker":"agent"}' | ergo new task
    echo '{"state":"done"}' | ergo set ABCDEF

  {{BOLD}}Multi-line bodies:{{RESET}} echo interprets \n as newlines, creating invalid JSON.
  Use heredoc or printf instead:

    ergo new task <<'EOF'
    {"title":"My task","body":"Line 1\nLine 2\nLine 3","worker":"agent"}
    EOF

    printf '%s' '{"title":"X","body":"Line 1\nLine 2"}' | ergo new task

  Schema (same for new and set):
    title           string    required for new; optional for set (non-empty)
    body            string    required for new; optional for set (non-empty)
    epic            string    optional; epic ID or "" to unassign
    worker          string    optional; any|agent|human
    state           string    optional; todo|doing|done|blocked|canceled|error
    claim           string    optional; agent ID or "" to unclaim
    result_path     string    optional; path to result file (requires result_summary)
    result_summary  string    optional; one-line summary (requires result_path)

  Validation errors return structured JSON:
    {"error":"validation_failed","message":"...","missing":["title","body"],"invalid":{...}}
