{{BOLD}}ergo{{RESET}} â€” fast, concurrency-safe task orchestration for agents. humans welcome.

{{HEADER}}USAGE{{RESET}}
  ergo [global flags] <command> [args]

{{HEADER}}COMMANDS{{RESET}}
  init [dir]                              create .ergo/ in dir (default: current dir)

  new epic                                create epic from JSON stdin (prints ID)
  new task                                create task from JSON stdin (prints ID)

  set <id>                                update task/epic from JSON stdin

  list [--epic <id>] [--ready|--blocked] [--epics]
                                          list tasks; --epics shows only epics
  show <id>                               show epic or task details

  next [--epic <id>] [--peek]             claim oldest READY task, set doing, print ID + body
                                          --peek shows without claiming; exit 3 if none

  dep <A> <B>                             add dependency: A depends on B (B blocks A)
  dep rm <A> <B>                          remove dependency

  where                                   print active .ergo directory path
  compact                                 rewrite log to current state (drops history)
  quickstart                              complete reference manual

{{HEADER}}GLOBAL FLAGS{{RESET}}
  --dir <path>                            discovery start dir (or explicit .ergo dir)
  --as <any|agent|human>                  filter READY/BLOCKED and next (default: any)
  --agent <id>                            claim identity (default: username@hostname)
  --json                                  JSON output (default: text)
  --readonly                              block commands that write
  --lock-timeout <duration>               default 30s; 0 = fail fast
  -h, --help                              show help
  -V, --version                           print version

{{HEADER}}FOR AGENTS{{RESET}}
  Use --json for structured output.  Use printf for JSON input (heredocs fail in
  programmatic terminals).  Run `ergo quickstart` for the full reference.

{{HEADER}}JSON INPUT (stdin only){{RESET}}
  All mutations (new, set) read JSON from stdin:

    printf '%s' '{"title":"Fix bug"}' | ergo new task
    printf '%s' '{"title":"Auth","body":"Implement login"}' | ergo new epic
    printf '%s' '{"state":"done"}' | ergo set TASKID

  Schema (same for new and set):
    title           string    required for new; optional for set
    body            string    optional; if omitted, title is used as body
    epic            string    optional; epic ID or "" to unassign
    worker          string    optional; any|agent|human
    state           string    optional; todo|doing|done|blocked|canceled|error
    claim           string    optional; agent ID or "" to unclaim
    result_path     string    optional; path to result file (requires result_summary)
    result_summary  string    optional; one-line summary (requires result_path)

  Validation errors return structured JSON:
    {"error":"validation_failed","message":"...","missing":["title"],"invalid":{...}}
